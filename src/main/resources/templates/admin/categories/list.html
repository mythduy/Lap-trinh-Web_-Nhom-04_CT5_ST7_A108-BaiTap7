<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout.html}" lang="vi">
<head>
<meta charset="UTF-8">
<title>Danh sÃ¡ch Category</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
	rel="stylesheet">
</head>
<body layout:fragment="content">
	<div class="container mt-4">

		<div class="d-flex justify-content-between align-items-center mb-3">
			<h2>Danh sÃ¡ch Category</h2>
			<a th:href="@{/admin/categories/add}" class="btn btn-primary">â•
				ThÃªm má»›i</a>
		</div>

		<!-- Ã” tÃ¬m kiáº¿m realtime -->
		<div class="row mb-3">
			<div class="col-md-4">
				<input type="text" id="searchInput" class="form-control"
					placeholder="Nháº­p tÃªn category Ä‘á»ƒ tÃ¬m..." />
			</div>
		</div>

		<!-- Báº£ng danh sÃ¡ch -->
		<table class="table table-striped table-hover">
			<thead class="table-dark">
				<tr>
					<th>ID</th>
					<th>TÃªn Category</th>
					<th>áº¢nh</th>
					<th>HÃ nh Ä‘á»™ng</th>
				</tr>
			</thead>
			<tbody id="categoryTableBody">
				<tr th:each="c : ${categories}">
					<td th:text="${c.id}"></td>
					<td th:text="${c.categoryName}"></td>
					<td><img th:if="${c.images != null}"
						th:src="@{'/uploads/category/' + ${c.images}}" width="100"
						class="img-thumbnail" /></td>
					<td><a th:href="@{'/admin/categories/edit/' + ${c.id}}"
						class="btn btn-sm btn-warning">âœï¸ Sá»­a</a> <a
						th:href="@{'/admin/categories/delete/' + ${c.id}}"
						class="btn btn-sm btn-danger"
						onclick="return confirm('Báº¡n cÃ³ cháº¯c muá»‘n xÃ³a?')">ğŸ—‘ï¸ XÃ³a</a></td>
				</tr>
			</tbody>
		</table>

		<!-- ThÃ´ng bÃ¡o -->
		<div th:if="${message != null}" class="alert alert-success">
			<span th:text="${message}"></span>
		</div>
	</div>

	<!-- JS Ä‘á»ƒ search realtime -->
	<script>
document.getElementById("searchInput").addEventListener("keyup", function() {
    const query = this.value;

    fetch("/admin/categories/search?name=" + query)
        .then(response => response.json())
        .then(data => {
            const tbody = document.getElementById("categoryTableBody");
            tbody.innerHTML = ""; // xoÃ¡ báº£ng cÅ©

            data.forEach(c => {
                const row = `
                    <tr>
                        <td>${c.id}</td>
                        <td>${c.categoryName}</td>
                        <td>
                            ${c.images ? `<img src="/uploads/category/${c.images}" width="100" class="img-thumbnail"/>` : ""}
                        </td>
                        <td>
                            <a href="/admin/categories/edit/${c.id}" class="btn btn-sm btn-warning">âœï¸ Sá»­a</a>
                            <a href="/admin/categories/delete/${c.id}" class="btn btn-sm btn-danger"
                               onclick="return confirm('Báº¡n cÃ³ cháº¯c muá»‘n xÃ³a?')">ğŸ—‘ï¸ XÃ³a</a>
                        </td>
                    </tr>`;
                tbody.innerHTML += row;
            });
        });
});
</script>

</body>
</html>